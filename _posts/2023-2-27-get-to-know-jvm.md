---
title: "认识JVM"
excerpt: ""
---

# 认识JVM

## Java Common Options

- `-Xms`：初始化分配的内存大小
- `-Xmx`：最大分配内存大小

为什么参数以 X 开始，X 为 `eXtend` 的缩写代表拓展的参数，为JVM标准未要求的部分。

- `-Dproperties=value`：定义系统属性值

`D` 为 Define 的缩写。

## 内存

程序计数器：占用小的内存空间，用于存储当前线程正在执行的命名的地址。

Java虚拟机栈：用于存储栈帧上局部变量、操作数栈、动态链接、方法出口等。

本地方法栈：存储Native的栈。

Java堆：最大的内存划分，用于存储Java对象。

方法区：存储被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码。

## 判定存活与回收

判定对象存活的算法：引用计数、可达性分析（常用）

回收算法：标记-清理、标记-复制、标记-整理。

## JVM 优化

### JIT

Java In Time，会在第一次运行时将字节码翻译成机器码。

具体步骤分为：

1. 启动字节码解释器，用于将字节码翻译为机器指令；

2. 热点代码探测，探测执行频率到、用时长的代码；

3. 编译优化，采用代码内联、死代码消除、常量折叠、循环展开等优化生成更高效的本地机器代码；

4. 编译缓存，将编译结果保存起来，以方便下次执行相同代码使用。