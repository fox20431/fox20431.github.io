# 构建你的第一个QT应用程序

该文档为 [bilibili 视频](https://www.bilibili.com/video/BV1PB4y1k7yz?p=6&spm_id_from=pageDriver&vd_source=24924a2b6e399f6354bb051bd87d3bb1) 观后感，通过 QT 库与工具链创建一个可运行窗口的应用。

## 安装 qt 及相关工具链

mac 操作系统

```sh
brew install qt
```

其他自行查阅相关介绍

## Visual Studio Code 准备工作

### 插件

你可以直接安装 `C/C++ Extension Pack` 拓展包，它包含以下拓展：

- C/C++
- C/C++ Themes（可选）
- CMake
- CMake Tools
- Generate Doxygen Comments（可选）
- Better C++ Syntax

### 插件配置

我们要为C和C++配置 `includePath`。

你可以在你打开的项目下使用 `palette`（快捷键 cmd + shift + p），输入 `c/c++: edit configuration`，可以为当前项目配置 `C/C++` 选项，下面是 Mac 操作系统下 QT 项目的参考：

```json
{
    "configurations": [
        {
            "name": "Mac",
            "includePath": [
                "${workspaceFolder}/**",
                "/usr/local/Cellar/qt/6.3.1_1/lib/**"
            ],
            "defines": [],
            "macFrameworkPath": [],
            "compilerPath": "/usr/bin/clang",
            "cStandard": "c11",
            "cppStandard": "c++17",
            "intelliSenseMode": "macos-gcc-arm"
        }
    ],
    "version": 4
}
```

## 开发代码

配置上述参数后，你可以在 Visusal Studio Code 中享受语法提示功能。

接下来进入开发过程，创建 `main.cpp` 文件，并写入：

```cpp
#include <QApplication>
#include <QLabel>

int main(int argc, char** argv) 
{
	QApplication app(argc, argv);
	QLabel label("Hello Qt!");
	label.show();
	// let app enter event loop
	return app.exec();
}
```

## 构建

构建过程中，依旧可以使用 `c++` 命令行，但是需要 `-I` /  `-L` /  `-l` 为其指定参数。

为了快速构建项目，`qmake` 命令行可以帮我们做到这些。

```shell
qmake -project
```

上述命令会生成以当前工作目录名为开头的`xxx.pro`文件，文件内容如下

```pro
######################################################################
# Automatically generated by qmake (3.1) Sat Aug 6 11:34:51 2022
######################################################################

TEMPLATE = app
TARGET = hello-demo
INCLUDEPATH += .

# You can make your code fail to compile if you use deprecated APIs.
# In order to do so, uncomment the following line.
# Please consult the documentation of the deprecated API in order to know
# how to port your code away from it.
# You can also select to disable deprecated APIs only up to a certain version of Qt.
#DEFINES += QT_DISABLE_DEPRECATED_BEFORE=0x060000    # disables all the APIs deprecated before Qt 6.0.0

# Input
SOURCES += main.cpp
```

你可以参考文档，根据上述源码使用的控件为其添加以下内容：

```
QT += widgets
```

然后再使用下述命令生成 `makefile` 文件

```shell
qmake
```

然后构建项目

```
make
```

请注意，make下构建的是一个以工作目录开头的 `xxx.app` 应用，应使用下述命令打开：

```shell
open xxx.app
```

到此，项目从环境到启动应用结束。 